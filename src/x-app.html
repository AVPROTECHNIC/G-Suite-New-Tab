<!-- Imports -->
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-localstorage/iron-localstorage.html">
<link rel="import" href="../bower_components/iron-signals/iron-signals.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/scale-up-animation.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="x-cards/x-bookmarks/x-bookmarks.html">
<link rel="import" href="x-cards/x-bookmarks/x-bookmarks-folder.html">
<link rel="import" href="x-cards/x-bookmarks/x-bookmarks-link-styles.html">
<link rel="import" href="x-cards/x-dashboard/x-dashboard.html">
<link rel="import" href="x-cards/x-cards.html">
<link rel="import" href="x-drawer/x-drawer.html">
<link rel="import" href="x-shortcuts/x-shortcuts.html">
<link rel="import" href="x-toolbar/x-toolbar-customize-dialog.html">
<link rel="import" href="x-toolbar/x-toolbar.html">

<!-- Element -->
<dom-module id="x-app">
  <template>

    <!-- CSS -->
    <style>

      /* App theme */
      :root {
        --primary-color: #009688;
        --main-background-color: #EEE;
        --light-gray-text-color: #AAA;
        --gray-text-color: #777;
        --darker-gray-text-color: #666;
        --dark-gray-text-color: #333;
        --border-color: #CCC;
      }

      /* Element */
      :host { display: block; }

      /* App panel */
      app-drawer-layout {}

      /* App panel - Drawer */
      app-drawer-layout app-drawer { --app-drawer-width: 312px; }

      /* App panel - Drawer - Drawer content */
      app-drawer-layout app-drawer x-drawer {}

      /* App panel - Content wrapper */
      app-drawer-layout app-header-layout {}

      /* App panel - Content wrapper - Header */
      app-drawer-layout app-header-layout app-header {}

      /* App panel - Content wrapper - Header - Toolbar */
      app-drawer-layout app-header-layout app-header app-toolbar { color: var(--gray-text-color); }

      /* App panel - Content wrapper - Header - Toolbar - Drawer toggle */
      app-drawer-layout app-header-layout app-header app-toolbar paper-icon-button {}

      /* App panel - Content wrapper - Header - Toolbar - App title */
      app-drawer-layout app-header-layout app-header app-toolbar div[main-title] { padding: 0 0 0 12px; }

      /* App panel - Content wrapper - Header - Toolbar - Toolbar controls */
      app-drawer-layout app-header-layout app-header app-toolbar x-toolbar {}

      /* App panel - Content wrapper - Content */
      app-drawer-layout app-header-layout main {}

      /* App panel - Content wrapper - Content - Shortcuts */
      app-drawer-layout app-header-layout main x-shortcuts { margin: 32px 0 0 0; }

      /* App panel - Content wrapper - Content - Cards */
      app-drawer-layout app-header-layout main x-cards {}

    </style>

    <!-- App layout -->
    <app-drawer-layout force-narrow>

      <!-- Drawer panel -->
      <app-drawer swipe-open>
        <x-drawer tabs="{{tabs}}"></x-drawer>
      </app-drawer>

      <!-- Main panel -->
      <app-header-layout id="headerPanel">

        <!-- Header -->
        <app-header effects="waterfall" fixed>
          <app-toolbar id="toolbar">

            <!-- Drawer toggle button -->
            <paper-icon-button icon="icons:menu" drawer-toggle></paper-icon-button>

            <!-- App title (empty) -->
            <div main-title>G Suite New Tab</div>

            <!-- Chrome:// controls -->
            <x-toolbar tabs="{{tabs}}" shortcuts="{{shortcuts}}"></x-toolbar>

          </app-toolbar>
        </app-header>

        <!-- Content -->
        <main id="content">

          <!-- Shortcuts -->
          <x-shortcuts shortcuts="{{shortcuts}}"></x-shortcuts>

          <!-- Cards -->
          <x-cards></x-cards>

        </main>

      </app-header-layout>

    </app-drawer-layout>

    <!-- Toast -->
    <paper-toast id="toast"></paper-toast>

    <!-- Signals event bus -->
    <iron-signals
      on-iron-signal-toast="_openToast">
    </iron-signals>

    <!-- Browser local storage -->
    <iron-localstorage name="__gsuitenewtab_tabs" value="{{tabs}}" on-iron-localstorage-load-empty="_tabsEmpty"></iron-localstorage>
    <iron-localstorage name="__gsuitenewtab_shortcuts" value="{{shortcuts}}" on-iron-localstorage-load-empty="_shortcutsEmpty"></iron-localstorage>

  </template>
  <script>
    (function () {
      'use strict';
      Polymer({

        /**
         * Element configuration (is, behaviors, properties, observers).
         */
        is: 'x-app',
        behaviors: [],
        properties: {

          /**
           * List of chrome://.. tabs used in drawer and toolbar.
           */
          tabs: {
            type: Array
          },

          /**
           * List of app shortcuts.
           */
          shortcuts: {
            type: Array
          }

        },
        observers: [],

        /**
         * Attach scroll observer on document when element is ready, monitor scrollTop value and change toolbar
         * background (default color when scrollTop is 0, lighter (closed to white) when scrollTop is more than 0).
         */
        ready: function () {
          document.addEventListener('scroll', function () {
            if (document.body.scrollTop > 0) {
              if (this.$.toolbar.style.backgroundColor !== '#FAFAFA') {
                this.$.toolbar.style.backgroundColor = '#FAFAFA';
              }
            } else {
              if (this.$.toolbar.style.backgroundColor !== '') {
                this.$.toolbar.style.backgroundColor = '';
              }
            }
          }.bind(this));
        },

        /**
         * If this.tabs variable is empty, set new default value for the array.
         *
         * @private
         */
        _tabsEmpty: function () {
          this.set('tabs', [
            { page: 'apps', icon: 'icons:apps', title: 'Apps', visible: true },
            { page: 'bookmarks', icon: 'icons:star', title: 'Bookmarks', visible: true },
            { page: 'downloads', icon: 'icons:file-download', title: 'Downloads', visible: true },
            { page: 'history', icon: 'icons:history', title: 'History', visible: true },
            { page: 'extensions', icon: 'icons:extension', title: 'Extensions', visible: true },
            { page: 'flags', icon: 'icons:flag', title: 'Flags', visible: true }
          ]);
        },

        /**
         * If this.shortcuts variable is empty, set new default value for the array.
         *
         * @private
         */
        _shortcutsEmpty: function () {
          this.set('shortcuts', [
            { type: 'web', icon: 'admin', title: 'Admin', page: 'https://admin.google.com/AdminHome', visible: true },
            { type: 'extension', icon: 'hangouts', title: 'Hangouts', page: 'knipolnnllmklapflnccelgolnpehhpl', visible: true },
            { type: 'web', icon: 'drive', title: 'Drive', page: 'https://drive.google.com/drive/my-drive', visible: true },
            { type: 'web', icon: 'keep', title: 'Keep', page: 'https://keep.google.com/', visible: true },
            { type: 'web', icon: 'calendar', title: 'Calendar', page: 'https://calendar.google.com/calendar/render', visible: true },
            { type: 'web', icon: 'inbox', title: 'Inbox', page: 'https://inbox.google.com', visible: true },
            { type: 'web', icon: 'my-account', title: 'My Account', page: 'https://myaccount.google.com/', visible: true },
            { type: 'web', icon: 'groups', title: 'Groups', page: 'https://groups.google.com/a/wds.sk/forum/#!myforums', visible: true },
            { type: 'web', icon: 'sites', title: 'Sites', page: 'https://sites.google.com/new', visible: true },
            { type: 'web', icon: 'gmail', title: 'Gmail', page: 'https://mail.google.com/mail/u/0/#inbox', visible: true },
            { type: 'web', icon: 'plus', title: 'Google+', page: 'https://plus.google.com/', visible: true },
            { type: 'web', icon: 'gitlab', title: 'Gitlab', page: 'http://gitlab.wds.sk/', visible: true },
            { type: 'web', icon: 'youtrack', title: 'Youtrack', page: 'http://wds.myjetbrains.com/youtrack/dashboard', visible: true }
          ]);
        },

        /**
         * Handler for iron-signal-toast event, opens paper-toast with a message from event.
         *
         * @param event
         * @private
         */
        _openToast: function (event) {
          if (this.$.toast.opened) {
            this.$.toast.hide();
          }
          this.$.toast.text = event.detail;
          this.$.toast.show();
        }

      });
    })();
  </script>
</dom-module>
